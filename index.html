<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Kostyuk Project | Premium Magic</title>

<meta name="description" content="–ü—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ —à–æ—É –∏–ª–ª—é–∑–∏–æ–Ω–∏—Å—Ç–∞ –î–º–∏—Ç—Ä–∏—è –ö–æ—Å—Ç—é–∫–∞.">
<meta property="og:title" content="Kostyuk Project">
<meta property="og:image" content="images/hero-portrait.png">
<meta name="theme-color" content="#050505">

<link rel="preload" as="image" href="images/hero-portrait.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Manrope:wght@300;400;600;800&family=Cormorant+Garamond:wght@600;700&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<style>
/* === –ö–û–ú–ü–ê–ö–¢–ù–´–ï –°–¢–ò–õ–ò === */
:root {
  --bg: #050505;
  --bg-panel: rgba(20, 20, 22, 0.95);
  --text: #F2F2F2;
  --gold-primary: #D4AF37;
  --gold-light: #F8E79B;
  --gold-dark: #8A6E2F;
  --gradient-gold: linear-gradient(135deg, var(--gold-primary) 0%, var(--gold-light) 50%, var(--gold-dark) 100%);
  --container: min(1000px, 94vw); /* –ß—É—Ç—å —É–∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
  --ff-head: 'Cinzel', serif;
  --ff-body: 'Manrope', sans-serif;
  --radius: 12px; /* –ê–∫–∫—É—Ä–∞—Ç–Ω—ã–µ —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è */
}

*,*::before,*::after{box-sizing:border-box;margin:0;padding:0;}
html { -webkit-font-smoothing: antialiased; scroll-behavior: smooth; font-size: 14px; /* –ë–∞–∑–æ–≤—ã–π —à—Ä–∏—Ñ—Ç –º–µ–Ω—å—à–µ */ }
body {
  font-family: var(--ff-body); background: var(--bg); color: var(--text);
  line-height: 1.5; overflow-x: hidden; margin: 0;
  height: 100vh; overflow-y: hidden;
}
body.loaded { overflow-y: auto; height: auto; }

/* UTILS */
.container { width: var(--container); margin: 0 auto; position: relative; z-index: 2; }
.section-py { padding-block: 40px; } /* –û—Ç—Å—Ç—É–ø—ã –º–µ–Ω—å—à–µ */
.text-gold { background: linear-gradient(to right, #D4AF37, #FFF5C3, #D4AF37); -webkit-background-clip: text; color: transparent; background-clip: text; font-weight: 700; }
.text-center { text-align: center; }
.icon-svg { width: 18px; height: 18px; fill: none; stroke: currentColor; stroke-width: 2; }

/* BUTTONS (–ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ) */
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 8px;
  padding: 10px 20px; border-radius: 50px; font-weight: 700; font-size: 0.85rem;
  text-transform: uppercase; letter-spacing: 0.05em; transition: 0.3s;
  position: relative; overflow: hidden; z-index: 1; border:none; outline:none; cursor: pointer; text-decoration: none;
}
.btn-primary { background: var(--gradient-gold); color: #000; box-shadow: 0 4px 15px rgba(212, 175, 55, 0.2); }
.btn-primary:hover { box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4); transform: translateY(-2px); }
.btn-glass { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: #fff; backdrop-filter: blur(4px); }
.btn-glass:hover { border-color: var(--gold-primary); background: rgba(255,255,255,0.1); }

/* INPUTS */
.input-field {
  width: 100%; background: rgba(20,20,20,0.8); border: 1px solid #333;
  padding: 12px; border-radius: 10px; color: #fff; font-size: 0.9rem; margin-bottom: 10px;
  backdrop-filter: blur(5px); outline: none;
}
.input-field:focus { border-color: var(--gold-primary); }
label { display: block; margin-bottom: 5px; font-size: 0.75rem; color: #888; text-transform: uppercase; letter-spacing: 0.05em; }

/* HEADER */
.header { position: fixed; top: 0; inset-inline: 0; z-index: 100; padding: 10px 0; background: rgba(5,5,5,0.95); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,0.05); }
.nav-flex { display: flex; justify-content: space-between; align-items: center; }
.logo { font-family: var(--ff-head); font-size: 1.2rem; font-weight: 900; color: #fff; text-decoration: none; }
.logo span { color: var(--gold-primary); margin-left: 4px; }
.burger { width: 32px; height: 32px; background: none; display: flex; flex-direction: column; justify-content: center; gap: 5px; border:none; cursor:pointer; }
.burger span { width: 22px; height: 2px; background: #fff; align-self: flex-end; transition: 0.3s; }
.burger.active span:nth-child(2) { opacity: 0; }
.burger.active span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
.burger.active span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }

/* MENU */
.mobile-menu {
  position: fixed; inset: 0; background: #000; z-index: 99;
  display: flex; flex-direction: column; justify-content: center; align-items: center; gap: 1rem;
  transform: translateY(-100%); transition: 0.4s cubic-bezier(0.16, 1, 0.3, 1);
  padding: 20px;
}
.mobile-menu.open { transform: translateY(0); }
.nav-card {
  width: 100%; max-width: 320px; padding: 25px 20px; border: 1px solid rgba(255,255,255,0.1); border-radius: 12px;
  text-decoration: none; text-align: center; transition: 0.3s; position: relative; overflow: hidden;
  background: #111; cursor: pointer; display: block;
}
.nav-card.gold { border-color: var(--gold-primary); background: linear-gradient(135deg, rgba(212,175,55,0.1), #000); }
.nav-card.gold h3 { color: #fff; } .nav-card.gold span { color: var(--gold-primary); }
.nav-card.silver { border-color: #555; background: linear-gradient(135deg, rgba(255,255,255,0.05), #000); }
.nav-card.silver h3 { color: #fff; } .nav-card.silver span { color: #aaa; }
.nav-card h3 { font-family: var(--ff-head); font-size: 1.2rem; margin: 5px 0 0; line-height: 1.2; text-transform: uppercase; }
.nav-card span { text-transform: uppercase; font-size: 0.65rem; letter-spacing: 0.2em; font-weight: 700; opacity: 0.8; }

/* HERO (Compact) */
.hero { height: 100dvh; min-height: 500px; display: flex; align-items: flex-end; padding-bottom: 90px; position: relative; overflow: hidden; }
.hero-img {
  position: absolute; right: 0; bottom: 0; height: 100%; width: 100%;
  background-image: url('images/hero-portrait.png'); 
  background-size: contain; background-repeat: no-repeat; background-position: bottom center;
  pointer-events: none; z-index: 1; opacity: 0; /* JS Animation */
}
#webgl-canvas { position: absolute; top:0; left:0; width:100%; height:100%; z-index:0; opacity: 0.6; }
@media (max-width: 768px) { 
    .hero { padding-bottom: 70px; align-items: center; justify-content: center; text-align: center; }
    .hero-img { width: 100%; height: 100%; background-size: cover; background-position: center top; opacity: 0.5; } 
    .hero-content { margin: 0; padding-top: 40px; }
    .hero-btns { justify-content: center; }
}

.hero-content { max-width: 600px; position: relative; z-index: 3; margin-bottom: 0; width: 100%; }
.hero-title { 
  font-family: var(--ff-head); 
  font-size: clamp(28px, 7vw, 56px); /* –£–º–µ–Ω—å—à–∏–ª —à—Ä–∏—Ñ—Ç */
  line-height: 1.1; margin-bottom: 12px; 
}
.hero-desc { 
  font-size: 0.95rem; color: #ddd; 
  text-shadow: 0 2px 5px rgba(0,0,0,0.9);
  margin-bottom: 25px; max-width: 400px; margin-inline: auto;
}
.hero-btns { display:flex; gap:12px; flex-wrap:wrap; }

/* PARTNERS (Compact) */
.partners-section { 
  padding: 25px 0; border-bottom: 1px solid #222; overflow: hidden; 
  background: rgba(8,8,8,0.8); position:relative; z-index:2; 
}
.partners-track { display: flex; gap: 30px; width: max-content; animation: scrollLogos 30s linear infinite; }
.partner-logo { height: 24px; width: auto; opacity: 0.9; flex-shrink: 0; display: block; }
@keyframes scrollLogos { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }

/* CARDS (Compact) */
.grid-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 15px; }
.card {
  padding: 20px; background: var(--bg-panel); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px;
  display: flex; flex-direction: column;
}
.card:hover { border-color: var(--gold-primary); }
.card-icon-wrap { margin-bottom: 12px; color: var(--gold-primary); }
.card h3 { font-family: var(--ff-head); font-size: 1.2rem; margin-bottom: 6px; color: #fff; }
.card-price { display: block; font-size: 0.9rem; color: var(--gold-primary); font-weight: 700; margin-bottom: 12px; }
.card ul li { padding-left: 15px; margin-bottom: 5px; color: #aaa; list-style: none; position: relative; font-size: 0.85rem; }
.card ul li::before { content: ''; position: absolute; left: 0; top: 7px; width: 5px; height: 5px; background: var(--gold-primary); border-radius: 50%; }

/* CALCULATOR (FIXED) */
.wizard-box {
  background: var(--bg-panel); border-radius: 16px; border: 1px solid #222; overflow: hidden;
  min-height: 400px; display: flex; flex-direction: column;
}
.wizard-progress { height: 3px; background: #222; width: 100%; }
.progress-bar { height: 100%; background: var(--gradient-gold); width: 33%; transition: 0.5s; }
.wizard-step { padding: 20px; display: none; flex: 1; flex-direction: column; animation: slideIn 0.3s ease; overflow-y: auto; }
.wizard-step.active { display: flex; }
@keyframes slideIn { from{opacity:0; transform:translateX(10px)} to{opacity:1; transform:translateX(0)} }
.step-title { font-family: var(--ff-head); font-size: 1.2rem; margin-bottom: 15px; color: #fff; text-align: center; }
.wiz-controls { margin-top: auto; display: flex; gap: 8px; padding-top: 15px; border-top: 1px solid #222; }

#svcOptions { display: flex; flex-direction: column; gap: 12px; }
.svc-group-title { color: var(--gold-primary); font-family: var(--ff-head); text-transform: uppercase; font-size: 0.75rem; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 4px; }
.svc-grid { display: grid; gap: 6px; grid-template-columns: 1fr; }
@media (min-width: 500px) { .svc-grid { grid-template-columns: 1fr 1fr; } }
.svc-btn {
  background: rgba(255,255,255,0.05); border: 1px solid #333; padding: 10px; border-radius: 8px;
  cursor: pointer; display: flex; flex-direction: column; justify-content: center;
}
.svc-btn.selected { border-color: var(--gold-primary); background: rgba(212, 175, 55, 0.15); }
.svc-name { font-weight: 700; color: #fff; font-size: 0.8rem; }
.svc-cost { font-size: 0.75rem; color: var(--gold-primary); }

.receipt { background: #000; padding: 15px; border-radius: 10px; border: 1px solid #333; margin-bottom: 15px; }
.receipt-row { display: flex; justify-content: space-between; margin-bottom: 8px; border-bottom: 1px dashed #333; padding-bottom: 4px; color: #bbb; font-size: 0.8rem; }
.receipt-total { font-size: 1.4rem; color: var(--gold-primary); font-family: var(--ff-head); text-align: right; display: block; margin-top: 10px; }

/* GAME */
.game-section { text-align: center; border-block: 1px solid #222; background: rgba(0,0,0,0.6); padding: 30px 0; }
.deck { display: flex; justify-content: center; gap: 8px; margin: 20px 0; perspective: 800px; }
.card-play { width: 70px; height: 100px; position: relative; transform-style: preserve-3d; transition: transform 0.6s; cursor: pointer; }
.card-play.flipped { transform: rotateY(180deg); }
.face { position: absolute; inset: 0; backface-visibility: hidden; border-radius: 6px; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; font-weight: bold; background: #fff; }
.back { background: linear-gradient(135deg, #111, #333); border: 2px solid var(--gold-primary); transform: rotateY(0deg); z-index: 2; }
.front { transform: rotateY(180deg); color: #000; }

/* FAQ & REVIEWS */
.faq-grid { display: grid; gap: 10px; }
details { background: var(--bg-panel); border: 1px solid #222; border-radius: 10px; padding: 12px; }
details[open] { border-color: var(--gold-primary); }
summary { font-weight: 700; cursor: pointer; color: #fff; font-size: 0.9rem; }
details p { margin-top: 8px; font-size: 0.85rem; color: #aaa; margin-bottom: 0; }

.reviews-grid { display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; }
.tg-circle { width: 80px; height: 80px; border-radius: 50%; overflow: hidden; border: 2px solid var(--gold-primary); cursor: pointer; margin-bottom: 8px; }
.tg-circle video { width: 100%; height: 100%; object-fit: cover; }

/* FOOTER */
footer { text-align:center; padding:20px 0; color:#444; font-size:0.7rem; border-top: 1px solid #111; }

/* PRELOADER */
.curtain-wrapper { position: fixed; inset: 0; z-index: 10000; display: flex; pointer-events: none; background: transparent; }
.curtain-bg { position: absolute; inset: 0; background: #000; z-index: 1; transition: opacity 0.5s; }
.curtain-panel { width: 50%; height: 100%; position: relative; z-index: 2; background-color: #4a0404; background-image: repeating-linear-gradient(90deg, rgba(0,0,0,0.8) 0%, rgba(80,0,0,0.5) 15%, rgba(0,0,0,0.8) 50%); }
.curtain-content { position: absolute; top: 45%; left: 50%; transform: translate(-50%, -50%); z-index: 10; text-align: center; width: 100%; }
.curtain-text { font-family: var(--ff-head); font-size: clamp(2rem, 5vw, 4rem); font-weight: 900; color: transparent; background: linear-gradient(to bottom, #FFF5C3, #D4AF37); -webkit-background-clip: text; background-clip: text; }

/* MODALS */
.modal { position: fixed; inset: 0; z-index: 200; background: rgba(0,0,0,0.95); display: none; align-items: center; justify-content: center; backdrop-filter: blur(10px); }
.modal.open { display: flex; }
.close-btn { position: absolute; top: 15px; right: 15px; color: #fff; font-size: 2rem; background: none; border: none; cursor: pointer; z-index: 201; }
</style>
</head>
<body>

<div class="magic-cursor"></div>

<div class="curtain-wrapper">
  <div class="curtain-bg"></div>
  <div class="curtain-panel left"></div>
  <div class="curtain-panel right"></div>
  <div class="curtain-content">
    <div class="curtain-text">KOSTYUK PROJECT</div>
  </div>
</div>

<canvas id="webgl-canvas"></canvas>

<header class="header">
  <div class="container nav-flex">
    <a href="#" class="logo">KOSTYUK <span>PROJECT</span></a>
    <button class="burger" onclick="toggleMenu()">
      <svg class="icon-svg" viewBox="0 0 24 24"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>
  </div>
</header>

<div class="mobile-menu" id="mobileMenu">
  <a href="afisha.html" class="nav-card gold" onclick="toggleMenu()">
    <span>–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤—ã –∏ –ü—Ä–∞–∑–¥–Ω–∏–∫–∏</span>
    <h3>–ö–û–ù–¶–ï–†–¢–ù–´–ï –®–û–£</h3>
  </a>
  <div style="height: 15px;"></div>
  <a href="school.html" class="nav-card silver" onclick="toggleMenu()">
    <span>–û–±—É—á–µ–Ω–∏–µ —Å –Ω—É–ª—è</span>
    <h3>–®–ö–û–õ–ê –§–û–ö–£–°–û–í</h3>
  </a>
</div>

<section id="hero" class="hero">
  <div class="hero-img"></div>
  <div class="container">
    <div class="hero-content">
      <h1 class="hero-title">–ú–∞–≥–∏—è <br><span class="text-gold">–í—ã—Å–æ–∫–æ–≥–æ –£—Ä–æ–≤–Ω—è</span></h1>
      <p class="hero-desc">–ü—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ —à–æ—É –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –≤–∏–¥–µ–ª –≤—Å—ë. –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ. –°—Ç–∏–ª—å–Ω–æ.</p>
      <div class="hero-btns">
        <button class="btn btn-glass" onclick="openVideo()">
          <svg class="icon-svg" viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
          –°–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–º–æ
        </button>
      </div>
    </div>
  </div>
</section>

<div class="partners-section">
  <div class="container" style="overflow:hidden;">
    <p class="text-center" style="color:#666; font-size:0.65rem; margin-bottom:15px; letter-spacing:0.1em; text-transform:uppercase;">–ù–∞–º –¥–æ–≤–µ—Ä—è—é—Ç</p>
    <div class="partners-track">
      <img src="images/logo-gazprom.png" class="partner-logo">
      <img src="images/logo-chery.png" class="partner-logo">
      <img src="images/logo-magnit.png" class="partner-logo">
      <img src="images/logo-rostelecom.png" class="partner-logo">
      <img src="images/logo-yaroslavl.png" class="partner-logo">
      <img src="images/logo-dixy.png" class="partner-logo">
      <img src="images/logo-beeline.png" class="partner-logo">
      <img src="images/logo-perekrestok.png" class="partner-logo">
      <img src="images/logo-megafon.png" class="partner-logo">
      <img src="images/logo-danone.png" class="partner-logo">
      <img src="images/logo-gazprom.png" class="partner-logo">
      <img src="images/logo-chery.png" class="partner-logo">
      <img src="images/logo-magnit.png" class="partner-logo">
    </div>
  </div>
</div>

<section id="formats" class="section-py">
  <div class="container">
    <h2 class="text-center" style="font-family:var(--ff-head); font-size:1.8rem; margin-bottom:30px;">–§–æ—Ä–º–∞—Ç—ã</h2>
    <div class="grid-cards">
      <div class="card">
        <h3>–ú–∏–∫—Ä–æ–º–∞–≥–∏—è</h3>
        <span class="card-price">–æ—Ç 13 000 ‚ÇΩ</span>
        <ul><li>Welcome-–∑–æ–Ω–∞</li><li>–§–æ–∫—É—Å—ã –≤ —Ä—É–∫–∞—Ö –≥–æ—Å—Ç–µ–π</li></ul>
      </div>
      <div class="card" style="border-color:var(--gold-dark);">
        <h3>–°—Ü–µ–Ω–∏—á–µ—Å–∫–æ–µ —à–æ—É</h3>
        <span class="card-price">–æ—Ç 17 500 ‚ÇΩ</span>
        <ul><li>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤ —Å –∑–∞–ª–æ–º</li><li>–ß—Ç–µ–Ω–∏–µ –º—ã—Å–ª–µ–π</li></ul>
      </div>
      <div class="card">
        <h3>–®–æ—É ¬´–°–ï–ö–†–ï–¢¬ª</h3>
        <span class="card-price">–æ—Ç 150 000 ‚ÇΩ</span>
        <ul><li>–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–æ–Ω—Ü–µ—Ä—Ç</li><li>–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π —Å–ø–µ–∫—Ç–∞–∫–ª—å</li></ul>
      </div>
    </div>
  </div>
</section>

<section id="calc" class="section-py">
  <div class="container">
    <h2 class="text-center" style="font-family:var(--ff-head); font-size:1.8rem; margin-bottom:30px;">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</h2>
    <div class="wizard-box">
      <div class="wizard-progress"><div class="progress-bar" id="wizProgress"></div></div>
      <div class="wizard-step active" id="step1">
        <h3 class="step-title">1. –ì–¥–µ –∏ –∫–æ–≥–¥–∞?</h3>
        <label>–†–µ–≥–∏–æ–Ω</label>
        <select id="area" class="input-field" onchange="updateCities()"><option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞—Å—Ç—å</option></select>
        <label>–ì–æ—Ä–æ–¥</label>
        <select id="city" class="input-field" disabled><option>–°–Ω–∞—á–∞–ª–∞ –æ–±–ª–∞—Å—Ç—å</option></select>
        <label>–î–∞—Ç–∞</label>
        <input type="date" id="date" class="input-field">
        <div class="wiz-controls"><button class="btn btn-primary" onclick="nextStep(2)" style="width:100%">–î–∞–ª–µ–µ</button></div>
      </div>
      <div class="wizard-step" id="step2">
        <h3 class="step-title">2. –£—Å–ª—É–≥–∏</h3>
        <div id="svcOptions" class="svc-grid"></div>
        <label style="margin-top:15px;">–ì–æ—Å—Ç–µ–π: <span id="gLabel" style="color:var(--gold-primary)">50</span></label>
        <input type="range" id="gRange" min="10" max="300" value="50" oninput="document.getElementById('gLabel').innerText=this.value" class="input-field" style="height:4px; padding:0">
        <div class="wiz-controls">
          <button class="btn btn-glass" onclick="nextStep(1)">–ù–∞–∑–∞–¥</button>
          <button class="btn btn-primary" onclick="calcResult()">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
        </div>
      </div>
      <div class="wizard-step" id="step3">
        <h3 class="step-title text-center">–°–º–µ—Ç–∞</h3>
        <div class="receipt">
          <div class="receipt-row"><span>–ü—Ä–æ–≥—Ä–∞–º–º–∞</span><strong id="rSvc" style="text-align:right">...</strong></div>
          <div class="receipt-row"><span>–õ–æ–≥–∏—Å—Ç–∏–∫–∞</span><span id="rRoad">0 ‚ÇΩ</span></div>
          <div class="receipt-row"><span>–ì–æ—Å—Ç–∏</span><span id="rGuest">0 ‚ÇΩ</span></div>
          <div class="receipt-row"><span>–°–µ–∑–æ–Ω–Ω—ã–π –∫–æ—ç—Ñ.</span><span id="rCoef">1.0</span></div>
          <div class="receipt-total"><span id="rTotal">0 ‚ÇΩ</span></div>
        </div>
        <div class="wiz-controls"><a href="#order" class="btn btn-primary" style="width:100%">–ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å</a><button class="btn btn-glass" onclick="nextStep(2)">–ò–∑–º–µ–Ω–∏—Ç—å</button></div>
      </div>
    </div>
  </div>
</section>

<section class="section-py game-section">
  <div class="container">
    <h2 style="font-family:var(--ff-head); font-size:1.6rem;">–ò—Å–ø—ã—Ç–∞–π —É–¥–∞—á—É</h2>
    <p style="color:#888; font-size:0.9rem;">–ù–∞–π–¥–∏ <span style="color:#fff">–¢—É–∑–∞ –ü–∏–∫</span> –∏ –ø–æ–ª—É—á–∏ —Å–∫–∏–¥–∫—É.</p>
    <div class="deck" id="gameDeck"></div>
    <div id="gameMsg" style="min-height:24px; color:var(--gold-light); font-weight:bold;"></div>
  </div>
</section>

<section class="section-py">
  <div class="container">
    <h2 class="text-center" style="font-family:var(--ff-head); font-size:1.8rem; margin-bottom:30px;">–í–æ–ø—Ä–æ—Å—ã</h2>
    <div class="faq-grid" id="faqContainer"></div>
  </div>
</section>

<section id="order" class="section-py">
  <div class="container" style="max-width:500px; text-align:center;">
    <h2 style="font-family:var(--ff-head); font-size:1.8rem; margin-bottom:15px;">–°–≤—è–∑—å</h2>
    <form id="tgForm">
      <input type="text" name="name" placeholder="–í–∞—à–µ –ò–º—è" class="input-field" required>
      <input type="tel" name="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" class="input-field" required>
      <button class="btn btn-primary" style="width:100%">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </form>
  </div>
</section>

<footer style="text-align:center; padding:30px 0; color:#444; font-size:0.7rem;">¬© 2025 –î–º–∏—Ç—Ä–∏–π –ö–æ—Å—Ç—é–∫</footer>

<div id="modalVideo" class="modal">
  <div class="modal-content" style="width:800px; aspect-ratio:16/9; background:#000; padding:0; border:none; position:relative;">
    <button class="close-btn" onclick="closeVideo()" style="right:10px; top:10px;">√ó</button>
    <div id="vidContainer" style="width:100%; height:100%"></div>
  </div>
</div>

<script>
window.addEventListener("DOMContentLoaded", () => {
    // 1. SCROLL TOP
    if (history.scrollRestoration) history.scrollRestoration = 'manual';
    window.scrollTo(0, 0);

    // 2. CURTAIN ANIMATION
    const tl = gsap.timeline({
        onComplete: () => {
            document.body.classList.add('loaded'); // Unlock Scroll
            document.querySelector('.hero-img').style.opacity = 1;
            const c = document.querySelector('.curtain-wrapper');
            if(c) { c.style.opacity = 0; setTimeout(() => c.style.display = 'none', 1000); }
        }
    });
    tl.to(".curtain-text", { opacity: 1, scale: 1, duration: 1.2, ease: "power2.out" })
      .to(".curtain-panel.left", { xPercent: -100, duration: 1.5, ease: "power2.inOut" }, "+=0.3")
      .to(".curtain-panel.right", { xPercent: 100, duration: 1.5, ease: "power2.inOut" }, "<")
      .to(".curtain-content", { opacity: 0, duration: 0.5 }, "<")
      .to(".curtain-bg", { opacity: 0, duration: 0.5 }, "-=1.0")
      .from(".hero-title", { y: 50, opacity: 0, duration: 1, ease: "power3.out" }, "-=0.8")
      .from(".hero-desc", { y: 20, opacity: 0, duration: 0.8 }, "-=0.5")
      .from(".hero-btns", { y: 20, opacity: 0, duration: 0.8 }, "-=0.5");

    // INIT
    initThreeJS();
    updateServices();
    initGame();
    
    // FAQ
    const faqData = [
        {q: "–ó–∞ —Å–∫–æ–ª—å–∫–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å?", a: "–û–±—ã—á–Ω–æ –∑–∞ 1‚Äì2 –Ω–µ–¥–µ–ª–∏."},
        {q: "–°–∫–æ–ª—å–∫–æ –¥–ª–∏—Ç—Å—è —à–æ—É?", a: "–û—Ç 20 –º–∏–Ω –¥–æ 2 —á–∞—Å–æ–≤."},
        {q: "–†–∞–±–æ—Ç–∞–µ—Ç–µ –ø–æ –¥–æ–≥–æ–≤–æ—Ä—É?", a: "–î–∞, –ò–ü/–°–∞–º–æ–∑–∞–Ω—è—Ç–æ—Å—Ç—å."},
        {q: "–í—ã–µ–∑–∂–∞–µ—Ç–µ –≤ –æ–±–ª–∞—Å—Ç—å?", a: "–î–∞, —É—Å–ª–æ–≤–∏—è –≤ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–µ."}
    ];
    document.getElementById('faqContainer').innerHTML = faqData.map((f,i) => 
        `<details class="faq-item"><summary>${f.q}</summary><div>${f.a}</div></details>`
    ).join('');
});

/* NAVIGATION */
function toggleMenu(){ 
    document.getElementById('mobileMenu').classList.toggle('open'); 
    document.querySelector('.burger').classList.toggle('active'); 
}

/* VIDEO MODAL */
function openVideo(){ 
    const m = document.getElementById('modalVideo');
    m.classList.add('open'); 
    document.getElementById('vidContainer').innerHTML = '<iframe src="https://rutube.ru/play/embed/a692a6ad3b922abc4cfad5be5898431b?autoplay=1" width="100%" height="100%" frameborder="0" allowfullscreen></iframe>'; 
}
function closeVideo(){ 
    const m = document.getElementById('modalVideo');
    m.classList.remove('open'); 
    document.getElementById('vidContainer').innerHTML = ''; 
}

/* CALCULATOR LOGIC (FIXED) */
const travel={ "–í–æ–ª–æ–≥–æ–¥—Å–∫–∞—è":{fee:9000,cities:{–í–æ–ª–æ–≥–¥–∞:9000,–ß–µ—Ä–µ–ø–æ–≤–µ—Ü:15000,–°–æ–∫–æ–ª:12000}}, "–í–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è":{fee:10000,cities:{–í–ª–∞–¥–∏–º–∏—Ä:10000,–ö–æ–≤—Ä–æ–≤:10000,–ú—É—Ä–æ–º:17000,"–ì—É—Å—å —Ö—Ä—É—Å—Ç–∞–ª—å–Ω—ã–π":13500}}, "–ò–≤–∞–Ω–æ–≤—Å–∫–∞—è":{fee:5000,cities:{–ò–≤–∞–Ω–æ–≤–æ:2000,–ö–∏–Ω–µ—à–º–∞:3500,–®—É—è:3000,–¢–µ–π–∫–æ–≤–æ:2500}}, "–ö–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è":{fee:3000,cities:{–ö–æ—Å—Ç—Ä–æ–º–∞:2000,–®–∞—Ä—å—è:6000,–ù–µ—Ä–µ—Ö—Ç–∞:2000}}, "–Ø—Ä–æ—Å–ª–∞–≤—Å–∫–∞—è":{fee:1000,cities:{–Ø—Ä–æ—Å–ª–∞–≤–ª—å:0,–†—ã–±–∏–Ω—Å–∫:2000,–¢—É—Ç–∞–µ–≤:2000,–£–≥–ª–∏—á:2000,–†–æ—Å—Ç–æ–≤:2000}} };
const services={ close: { "–ú–∏–∫—Ä–æ–º–∞–≥–∏—è": 13000 }, std: { "–®–æ—É": 17500 }, conc: { "–ö–æ–Ω—Ü–µ—Ä—Ç": 150000 } };
const catNames = { close: "–ú–∏–∫—Ä–æ–º–∞–≥–∏—è", std: "–®–æ—É", conc: "–ö–æ–Ω—Ü–µ—Ä—Ç" };
const els={area:document.getElementById('area'),city:document.getElementById('city'),svcGrid:document.getElementById('svcOptions'),date:document.getElementById('date'),gRange:document.getElementById('gRange')};
Object.keys(travel).forEach(k=>els.area.add(new Option(k,k)));

function updateCities(){els.city.innerHTML='<option disabled selected>–ì–æ—Ä–æ–¥</option>';els.city.disabled=false;Object.keys(travel[els.area.value].cities).forEach(c=>els.city.add(new Option(c,c)));}

let selectedServices = [];
function updateServices(){
  const grid = document.getElementById('svcOptions');
  grid.innerHTML='';
  Object.keys(services).forEach(catKey => {
    const wrapper = document.createElement('div'); wrapper.className = 'svc-category-group';
    const header = document.createElement('div'); header.className = 'svc-group-title'; header.innerText = catNames[catKey]; wrapper.appendChild(header);
    const g = document.createElement('div'); g.className = 'svc-grid';
    Object.keys(services[catKey]).forEach(sName => {
      const btn = document.createElement('div'); btn.className = 'svc-btn';
      btn.innerHTML = `<span class="svc-name">${sName}</span><span class="svc-cost">${services[catKey][sName].toLocaleString()} ‚ÇΩ</span>`;
      btn.onclick = () => toggleService(btn, sName, services[catKey][sName]);
      g.appendChild(btn);
    });
    wrapper.appendChild(g); grid.appendChild(wrapper);
  });
}
function toggleService(btn, name, price) {
  const idx = selectedServices.findIndex(s => s.name === name);
  if (idx > -1) { selectedServices.splice(idx, 1); btn.classList.remove('selected'); } 
  else { selectedServices.push({name, price}); btn.classList.add('selected'); }
}

function nextStep(n){
  if(n===2 && (!els.area.value||!els.city.value)){alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω –∏ –≥–æ—Ä–æ–¥');return;}
  document.querySelectorAll('.wizard-step').forEach(e=>e.classList.remove('active'));
  document.getElementById('step'+n).classList.add('active');
  document.getElementById('wizProgress').style.width=(n*33)+'%';
}

function calcResult(){
  if (selectedServices.length === 0) { alert('–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É'); return; }
  let base = selectedServices.reduce((sum, s) => sum + s.price, 0);
  const road = travel[els.area.value].cities[els.city.value];
  const g = parseInt(els.gRange.value); 
  const total = base + road + (g>50 ? (g-50)*50 : 0);
  document.getElementById('rSvc').innerHTML = selectedServices.map(s => s.name).join('<br>');
  document.getElementById('rRoad').innerText=road.toLocaleString()+' ‚ÇΩ';
  document.getElementById('rTotal').innerText=total.toLocaleString()+' ‚ÇΩ';
  nextStep(3);
}

/* GAME */
function initGame() {
    const deck = document.getElementById('gameDeck');
    const msg = document.getElementById('gameMsg');
    if (!deck) return;
    deck.innerHTML = '';
    const winIdx = Math.floor(Math.random() * 3);
    for (let i = 0; i < 3; i++) {
        const isWin = (i === winIdx);
        const card = document.createElement('div'); card.className = 'card-play';
        card.innerHTML = `<div class="face back"></div><div class="face front" style="color:#000">${isWin ? 'A‚ô†' : 'J‚ô•'}</div>`;
        card.onclick = () => {
            document.querySelectorAll('.card-play').forEach(el => el.classList.add('flipped'));
            if (isWin) { msg.innerText = '–ü–û–ë–ï–î–ê! –°–∫–∏–¥–∫–∞ 20%'; } 
            else { msg.innerText = '–£–≤—ã...'; }
        };
        deck.appendChild(card);
    }
}

/* PARTICLES */
function initThreeJS() {
  const container = document.getElementById('webgl-canvas');
  if(!container) return;
  // –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –±–µ–∑ —Ç—è–∂–µ–ª—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
}

/* TELEGRAM */
const TG_TOKEN = "7838972787:AAHaLNVe6xqEnzE5qy5Uh2TwSb66LWYIUhI";
const CHAT_ID = '–í–°–¢–ê–í–¨_–°–Æ–î–ê_–¶–ò–§–†–´_CHAT_ID'; 
document.getElementById('tgForm').onsubmit = async (e) => {
    e.preventDefault();
    const btn = e.target.querySelector('button');
    btn.innerText = '–û—Ç–ø—Ä–∞–≤–∫–∞...'; btn.disabled = true;
    const fData = new FormData(e.target);
    const text = `üî• –ó–∞—è–≤–∫–∞: ${fData.get('name')} | ${fData.get('phone')}`;
    try {
        await fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendMessage`, {
            method: 'POST', headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ chat_id: CHAT_ID, text: text })
        });
        btn.innerText = '–£—Å–ø–µ—à–Ω–æ!'; btn.style.background = '#28a745'; e.target.reset();
    } catch (err) { alert('–û—à–∏–±–∫–∞'); btn.disabled = false; }
};
</script>

</body>
</html>
